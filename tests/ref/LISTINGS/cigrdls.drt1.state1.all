
&& iteration number 1 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

  program cigrd

 effective density and fock matrix construction for analytic energy
 gradient evaluation for general mrci wave functions

 programmed by: ron shepard and hans lischka

 references:  r. shepard, int. j. quantum chem. 31, 33 (1987).

              r. shepard, i. shavitt, r. m. pitzer, d. c. comeau, m. pepper,
                   h. lischka, p. g. szalay, r. ahlrichs, f. b. brown,
                   and j.-g. zhao, int. j. quantum chem. s22, 149 (1988).

              h. lischka, r. shepard, r. m. pitzer, i. shavitt, m. dallos, t.
                   muller, p. g. szalay, m. seth, g. s. kedziora, s. yabushita,
                   and z. zhang, phys. chem. chem. phys. 3, 664-673 (2001).

 version date: 13-aug-01

 state-averag modifications:
    X.1999, by: Michal Dallos
    University Vienna, Austria


     ******************************************
     **    PROGRAM:              CIGRD       **
     **    PROGRAM VERSION:      5.4.2b      **
     **    DISTRIBUTION VERSION: 5.9.a       **
     ******************************************


 This Version of Program cigrd is Maintained by:
     Thomas Mueller
     Juelich Supercomputing Centre (JSC)
     Institute of Advanced Simulation (IAS)
     D-52425 Juelich, Germany 
     Email: th.mueller@fz-juelich.de


 workspace allocation information: lencor=    65536000 mem1=               0 ifirst=               1

 ===echo of the user input===============================================
  &input                                                                         
  nmiter= 100, print=0, fresdd=1,                                                
  fresaa=1, fresvv=1,                                                            
  mdir=0,                                                                        
  cdir=1,                                                                        
  rtol=1e-6, dtol=1e-6,                                                          
  wndtol=1e-7,wnatol=1e-7,wnvtol=1e-7                                            
   nadcalc=0                                                                     
   samcflag=0                                                                    
   assume_fc=0                                                                   
  &end                                                                           
 ========================================================================

 input parameters:
 cigopt(*)=   0  1  1  1  0  0  0  0  0  0
 ldamin=     511 ldamax=    4095 ldainc=      64
 lenm1e=    2047 n1embf=    1636 lenm2e=    2047 n2embf=    1364

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
      1       6    cigrdls                                                     

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
      2       5    cigrdin                                                     

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
      3      10    cidrtfl                                                     

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
      4      11    moints                                                      

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
      5      12    cid1fl                                                      

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
      6      13    cid2fl                                                      

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
      7      14    mcdrtfl                                                     

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
      8      15    mcd1fl                                                      

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
      9      16    mcd2fl                                                      

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     10      17    mcdrtfl.*                                                   

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     11      36    civout.xx                                                   

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     12      19    restart                                                     

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     13      20    mchess                                                      

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     14      21    effd1fl                                                     

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     15      22    effd2fl                                                     

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     16      23    nocoef_cigrd                                                

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     17      50    mcscr2                                                      

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     18      51    hdiagf                                                      

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     19      24    mcscfin                                                     

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     20      25    moints2                                                     

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     21      63    mciscr                                                      

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     22      33    cid1trfl                                                    

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     23      35    mcdftfl.*                                                   

 internal fortran  initial
   unit    unit    filename
  ------  ------   --------
     24      34    mcoftfl.*                                                   

  Calculation mode:
  MR-CISD/MR_AQCC calculation.


 MCSCF user input information:

 ======== echo of the mcscf input ========
 ------------------------------------------------------------------------
  &input
   niter=100,
   nmiter=50,
   nciitr=50,
   tol(3)=1.e-5,
   tol(2)=1.e-5,
   tol(1)=1.e-9,
   NSTATE=0,
   npath=1,3,9,10,13,17,19,21,11,-12, 2,
   ncoupl=5,
   tol(9)=1.e-3,
   FCIORB=  1,1,20,1,2,20
   NAVST(1) = 2,
   WAVST(1,1)=1 ,
   WAVST(1,2)=1 ,
  &end
 ------------------------------------------------------------------------

 ***  State averaging information: ***

 MCSCF calculation performed for  1 DRT.

 DRT  first state   no.of aver. states   weights
  1   ground state          2             0.500 0.500

 listing file: fortran unit= 6, name( 1)=/tmp/schuurm/COLSCR/WORK/cigrdls                            

 input file: fortran unit= 5, name( 2)=/tmp/schuurm/COLSCR/WORK/cigrdin                            

 input file: fortran unit=24, name(19)=/tmp/schuurm/COLSCR/WORK/mcscfin                            

 mo integrals file: fortran unit=11, name( 4)=/tmp/schuurm/COLSCR/WORK/moints                             
 moint file header information
   ntitle =   5     nsym =   1     nmot =  10
    ninfo =   6   nenrgy =   1
  A     10
 info(*)=    1 8192 6552 8192 5460    0
 labels(:)=
   1: tout:001   2: tout:002   3: tout:003   4: tout:004   5: tout:005   6: tout:006   7: tout:007   8: tout:008
   9: tout:009  10: tout:010
 moint file header information
 Hermit Integral Program : SIFS version  localhost.localdo 22:20:22.805 02-Jan-16
  cidrt_title DRT#1                                                              
 MO-coefficients from mcscf.x                                                    
  total ao core energy =    0.713754049                                          
 SIFS file created by program tran.      localhost.localdo 22:20:22.972 02-Jan-16
 moint core energy(*) values:
 energy( 1)=  7.137540490910E-01, ietype=   -1,    core energy of type: Nuc.Rep.

    total mo core energy =   7.137540490910E-01
 
  1-e CI density read from file:
 cid1fl                                                      
  2-e CI density read from file:
 cid2fl                                                      

 ci 1-particle density file: fortran unit=12, name( 5)=/tmp/schuurm/COLSCR/WORK/cid1fl                             
extracted nexo info=   8   0   0   0   0   0   0   0

 ci density file header information:
 CI Density matrices, Root #   1                                                 
 NEXO(*)=   8   0   0   0   0   0   0   0                                        
 (isym:nbpsy)  1: 10
 energy( 1)= -1.139858471882E+00, ietype=-1026,   total energy of type: MRSDCI  

 ci drt file: fortran unit=10, name( 3)=/tmp/schuurm/COLSCR/WORK/cidrtfl                            
 symmetry labels:  a  

 ci drt information:
  cidrt_title DRT#1                                                              
 nmotd =  10 nfctd =   0 nfvtd =   0 nmot  =  10
 niot  =   2
 cidrt header read

   ******  MCSCF DRT info section  ******

 Information for MCSCF DRT number  1

 mcscf drt header information:
  title                                                                          
 Molecular symmetry group:    a  
 Total number of electrons:    2
 Spin multiplicity:            1
 Number of doubly occ.orbital  0
 Number of active orbitals:    2
 Number of active electrons:   2
 Total number of CSFs:         3

 mapml(*)   1   2

 mcscf restart file: fortran unit=19, name(12)=/tmp/schuurm/COLSCR/WORK/restart                            
docc:                 0
active:               2
internal:             2
virtual:              8

 mcscf 1-particle density file: fortran unit=15, name( 8)=/tmp/schuurm/COLSCR/WORK/mcd1fl                             
 energy( 1)=  7.137540490910E-01, ietype=   -1,    core energy of type: Nuc.Rep.
 energy( 2)= -8.768597904153E-01, ietype=-1025,   total energy of type: MCSCF   
 energy( 3)=  7.327261020151E-11, ietype=-2050, cnvginf energy of type: MC-D.E. 
 energy( 4)=  4.252650873272E-07, ietype=-2051, cnvginf energy of type: MC-Wnorm
 energy( 5)=  2.198546777129E-07, ietype=-2052, cnvginf energy of type: MC-Knorm
 energy( 6)=  4.672900345698E-14, ietype=-2053, cnvginf energy of type: MC-ApxDE

 mcscf density file header information:
 NO-coefficients from mcscf.x                                                    
  total ao core energy =    0.713754049                                          
 elast:     -8.768597904152744E-01 hartree.
 total number of irreps: 1
 (isym:nipsy)  1:  2
 (isym:nmpsy)  1: 10
 nonzero mcres(*) orbital masks:
 orbital=   1 mask=  00000020
 orbital=   2 mask=  00000020
 mo-to-internal mapping vector [i:mo(i)]:
    1:  1    2:  2    3:  0    4:  0    5:  0    6:  0    7:  0    8:  0    9:  0   10:  0
 mcd1fl header information read

 faar:   0 active-active rotations allowed out of:   1 possible.


 Size of orbital-Hessian matrix B:                      192
  1. B[ad,ad]              0
  2. B[aa,ad]              0
  3. B[aa,aa]              0
  4. B[vd,ad]              0
  5. B[vd,aa]              0
  6. B[vd,vd]              0
  7. B[va,ad]              0
  8. B[va,aa]              0
  9. B[va,vd]              0
  10.B[va,va]            192

 Size of the orbital-state Hessian matrix C:              0
  11.C[csf,ad]              0
  12.C[csf,aa]              0
  13.C[csf,vd]              0
  14.C[csf,va]              0

 Total size of the state Hessian matrix M:               21
 Size of HESSIAN-matrix for quadratic conv.:            213

 one electron hamiltonian and overlap integrals read
   1   2   3   4   5   6   7   8   9  10

          d1 array block   1

                MO   1         MO   2         MO   3         MO   4         MO   5         MO   6         MO   7         MO   8
   MO   1    1.97418    
   MO   2    0.00000       1.250369E-02
   MO   3   0.122875        0.00000       7.681647E-03
   MO   4    0.00000       5.989693E-03    0.00000       4.552458E-03
   MO   7  -4.451296E-02    0.00000      -2.782773E-03    0.00000        0.00000        0.00000       1.008094E-03
   MO  10    0.00000       7.456860E-04    0.00000       5.667577E-04    0.00000        0.00000        0.00000        0.00000    

                MO   9         MO  10
   MO  10    0.00000       7.055842E-05

 dalen: da sorting parameters, nbuk=   1 lendar=    4095 nvpbk=        2729 nvpsg=        3025
getmosize:+labels=        9075
 beginning two-electron integral sort...
 sort1: nvals=       354 nvlout=       653

 ci 2-particle density file: fortran unit=13, name( 6)=/tmp/schuurm/COLSCR/WORK/cid2fl                             
 beginning two-particle density matrix sort...
 sort1: nvals=        31 nvlout=        55
 IOSRES:wnatol  1.000000000000000E-007

   Block resolution info:
 numaa  =     0
 numado =     0
 numaf  =   100
 qfresd = F
 qfresa = F
 qfresv = T
 qresaf = F
 mcd1fl and fock matrices read
 IOSRES:wnatol  1.000000000000000E-007
 essential virtual-active rotations

 mcscf restart file: fortran unit=19, name(12)=/tmp/schuurm/COLSCR/WORK/restart                            
 lenm2e_mc =  4096
 n2embf_mc =  2730
 ifmt,ifmtin:                     0                     0

 mosort: allocated sort2 space, avc2is=    65462668 available sort2 space, avcisx=    65462668

 mcscf hessian file: fortran unit=20, name(13)=/tmp/schuurm/COLSCR/WORK/mchess                             

 ************************************************************

   Solution of the Linear System of Equations:

     Desired residual norm convergence = 1.0000E-06
     Minimum denominater value: dtol = 1.0000E-06
     Maximum subspace dimension for r vector =  16
     Maximum subspace dimension for s vector =   5
     Maximum number of iterations: nmiter = 100
     Dimension of Lambda[orb]:  16
     Dimension of Lambda[csf]:     6

 miter=  1 |orbl|= 1.5327E-02 |csfl|= 0.0000E+00 rznorm= 2.8155E-02 rpnorm= 1.0206E-03 noldr=  1 nnewr=  2 nolds=  0 nnews=  1
 miter=  2 |orbl|= 3.5867E-02 |csfl|= 4.9671E-03 rznorm= 4.7313E-03 rpnorm= 4.3688E-17 noldr=  2 nnewr=  3 nolds=  1 nnews=  1
 miter=  3 |orbl|= 3.6617E-02 |csfl|= 5.1189E-03 rznorm= 4.5179E-05 rpnorm= 4.5381E-17 noldr=  3 nnewr=  4 nolds=  1 nnews=  1
 lmicro: final convergence values.
 miter=  4 |orbl|= 3.6618E-02 |csfl|= 5.1182E-03 rznorm= 9.7256E-18 rpnorm= 4.6840E-17 noldr=  4 nnewr=  4 nolds=  1 nnews=  1

 ************************************************************

 mcscf hessian file read and processed

 mcscf 2-particle density file: fortran unit=16, name( 9)=/tmp/schuurm/COLSCR/WORK/mcd2fl                             

 effective 1-particle density file: fortran unit=21, name(14)=/tmp/schuurm/COLSCR/WORK/effd1fl                            
 icd(44):                     1                  3080
 icd(45):                     1                  4095
 icd(46):                     1                  2729
 icd(47):                     1                  2730
 mcscf restart read

 wrnat: orbital occupations and coefficents for the effective density matrix d1_eff(:,:) were written.

 effno and effocc file : fortran unit=23, name(16)=/tmp/schuurm/COLSCR/WORK/nocoef_cigrd                       
 beginning effective two-particle density matrix sort...
 sort1: nvals=        39 nvlout=        71

 ************************************************************

        ***  RESULTS:  ***

     norm of Lambda(orb) =      0.03661784
     norm of Lambda(csf) =      0.00489896

     isym= 1   tr(d1(eff)*h) - tr(d1*h)=      -0.095489730851
tr(d1(eff)*h)=       -2.4940217962
tr(d1*h)     =       -2.4844728231
tr((d1(eff)-d1)*h)=       -0.0095489731

      eci = tr(d1*h) + tr(d2*g) + repnuc =                      -1.139858471882
      eci(eff) = tr(d1eff * h) + tr(d2eff * g) + repnuc =       -1.139858459747
      eci(ciudg.x)              =                               -1.139858471882

      abs(eci - eci(eff))       =  1.2136E-08

      abs(eci(ciudg.x)-eci)=  4.4409E-16

      abs(eci(ciudg.x)-eci(eff))=  1.2136E-08

 effective 1-particle density file: fortran unit=21, name(14)=/tmp/schuurm/COLSCR/WORK/effd1fl                            
